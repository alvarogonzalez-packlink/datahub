"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[71202],{79106:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>y});r(96540);var a=r(15680),n=r(53720),i=r(5400);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const s={title:"Structured Properties",slug:"/api/tutorials/structured-properties",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/structured-properties.md"},u="Structured Properties",d={unversionedId:"docs/api/tutorials/structured-properties",id:"docs/api/tutorials/structured-properties",title:"Structured Properties",description:"Why Would You Use Structured Properties?",source:"@site/genDocs/docs/api/tutorials/structured-properties.md",sourceDirName:"docs/api/tutorials",slug:"/api/tutorials/structured-properties",permalink:"/docs/api/tutorials/structured-properties",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/structured-properties.md",tags:[],version:"current",frontMatter:{title:"Structured Properties",slug:"/api/tutorials/structured-properties",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/structured-properties.md"},sidebar:"overviewSidebar",previous:{title:"Ownership",permalink:"/docs/api/tutorials/owners"},next:{title:"Tags",permalink:"/docs/api/tutorials/tags"}},c={},y=[{value:"Why Would You Use Structured Properties?",id:"why-would-you-use-structured-properties",level:2},{value:"Goal Of This Guide",id:"goal-of-this-guide",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Create Structured Properties",id:"create-structured-properties",level:2},{value:"Read Structured Properties",id:"read-structured-properties",level:2},{value:"Set Structured Property To a Dataset",id:"set-structured-property-to-a-dataset",level:2},{value:"Expected Outcomes",id:"expected-outcomes",level:4},{value:"Patch Structured Property Value",id:"patch-structured-property-value",level:2},{value:"Add Structured Property Value",id:"add-structured-property-value",level:3},{value:"Expected Outcomes",id:"expected-outcomes-1",level:4},{value:"Remove Structured Property Value",id:"remove-structured-property-value",level:3},{value:"Expected Outcomes",id:"expected-outcomes-2",level:4},{value:"Upsert Structured Property Value",id:"upsert-structured-property-value",level:3},{value:"Expected Outcomes",id:"expected-outcomes-3",level:4},{value:"Delete Structured Properties",id:"delete-structured-properties",level:2}],m={toc:y},g="wrapper";function h(e){var{components:t}=e,r=l(e,["components"]);return(0,a.yg)(g,p(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){o(e,t,r[t])}))}return e}({},m,r),{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"structured-properties"},"Structured Properties"),(0,a.yg)("h2",{id:"why-would-you-use-structured-properties"},"Why Would You Use Structured Properties?"),(0,a.yg)("p",null," Structured properties are a structured, named set of properties that can be attached to logical entities like Datasets, DataJobs, etc.\nStructured properties have values that are types. Conceptually, they are like \u201cfield definitions\u201d."),(0,a.yg)("p",null,"Learn more about structured properties in the ",(0,a.yg)("a",{parentName:"p",href:"/docs/features/feature-guides/properties"},"Structured Properties Feature Guide"),"."),(0,a.yg)("h3",{id:"goal-of-this-guide"},"Goal Of This Guide"),(0,a.yg)("p",null,"This guide will show you how to execute the following actions with structured properties."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Create structured properties"),(0,a.yg)("li",{parentName:"ul"},"Read structured properties"),(0,a.yg)("li",{parentName:"ul"},"Delete structured properties (soft delete)"),(0,a.yg)("li",{parentName:"ul"},"Add structured properties to a dataset"),(0,a.yg)("li",{parentName:"ul"},"Patch structured properties (add / remove / update a single property)")),(0,a.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.yg)("p",null,"For this tutorial, you need to deploy DataHub Quickstart and ingest sample data.\nFor detailed information, please refer to ",(0,a.yg)("a",{parentName:"p",href:"/docs/quickstart"},"Datahub Quickstart Guide"),"."),(0,a.yg)("p",null,"Additionally, you need to have the following tools installed according to the method you choose to interact with DataHub:"),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"CLI",label:"CLI",default:!0,mdxType:"TabItem"},(0,a.yg)("p",null,"Install the relevant CLI version. Forms are available as of CLI version ",(0,a.yg)("inlineCode",{parentName:"p"},"0.13.1"),". The corresponding SaaS release version is ",(0,a.yg)("inlineCode",{parentName:"p"},"v0.2.16.5"),"\nConnect to your instance via ",(0,a.yg)("a",{parentName:"p",href:"/docs/cli/#init"},"init"),":"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Run ",(0,a.yg)("inlineCode",{parentName:"li"},"datahub init")," to update the instance you want to load into."),(0,a.yg)("li",{parentName:"ul"},"Set the server to your sandbox instance, ",(0,a.yg)("inlineCode",{parentName:"li"},"https://{your-instance-address}/gms"),"."),(0,a.yg)("li",{parentName:"ul"},"Set the token to your access token."))),(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("p",null,"Requirements for OpenAPI are:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"curl"),(0,a.yg)("li",{parentName:"ul"},"jq")))),(0,a.yg)("h2",{id:"create-structured-properties"},"Create Structured Properties"),(0,a.yg)("p",null,"The following code will create a structured property ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime"),". "),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"CLI",label:"CLI",default:!0,mdxType:"TabItem"},(0,a.yg)("p",null,"Create a yaml file representing the properties you\u2019d like to load.\nFor example, below file represents a property ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime"),". You can see the full example ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/example-yaml-sp/metadata-ingestion/examples/structured_properties/struct_props.yaml"},"here"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},'- id: io.acryl.privacy.retentionTime\n  # - urn: urn:li:structuredProperty:io.acryl.privacy.retentionTime # optional if id is provided\n  qualified_name: io.acryl.privacy.retentionTime # required if urn is provided\n  type: number\n  cardinality: MULTIPLE\n  display_name: Retention Time\n  entity_types:\n    - dataset # or urn:li:entityType:datahub.dataset\n    - dataFlow\n  description: "Retention Time is used to figure out how long to retain records in a dataset"\n  allowed_values:\n    - value: 30\n      description: 30 days, usually reserved for datasets that are ephemeral and contain pii\n    - value: 90\n      description: Use this for datasets that drive monthly reporting but contain pii\n    - value: 365\n      description: Use this for non-sensitive data that can be retained for longer\n')),(0,a.yg)("p",null,"Use the CLI to create your properties:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},"datahub properties upsert -f {properties_yaml}\n")),(0,a.yg)("p",null,"If successful, you should see ",(0,a.yg)("inlineCode",{parentName:"p"},"Created structured property urn:li:structuredProperty:..."))),(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},'curl -X \'POST\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/structuredProperty/urn%3Ali%3AstructuredProperty%3Aio.acryl.privacy.retentionTime/propertyDefinition\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n        "qualifiedName": "io.acryl.privacy.retentionTime",\n      "valueType": "urn:li:dataType:datahub.number",\n      "description": "Retention Time is used to figure out how long to retain records in a dataset",\n      "displayName": "Retention Time",\n      "cardinality": "MULTIPLE",\n      "entityTypes": [\n        "urn:li:entityType:datahub.dataset",\n        "urn:li:entityType:datahub.dataFlow"\n          ],\n      "allowedValues": [\n        {\n          "value": {"double": 30},\n          "description": "30 days, usually reserved for datasets that are ephemeral and contain pii"\n        },\n        {\n          "value": {"double": 60},\n          "description": "Use this for datasets that drive monthly reporting but contain pii"\n        },\n        {\n          "value": {"double": 365},\n          "description": "Use this for non-sensitive data that can be retained for longer"\n        }\n      ]\n}\' | jq\n')))),(0,a.yg)("h2",{id:"read-structured-properties"},"Read Structured Properties"),(0,a.yg)("p",null,"You can see the properties you created by running the following command:"),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"CLI",label:"CLI",default:!0,mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},"datahub properties get --urn {urn}\n")),(0,a.yg)("p",null,"For example, you can run ",(0,a.yg)("inlineCode",{parentName:"p"},"datahub properties get --urn urn:li:structuredProperty:io.acryl.privacy.retentionTime"),".\nIf successful, you should see metadata about your properties returned."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},'{\n  "urn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime",\n  "qualified_name": "io.acryl.privacy.retentionTime",\n  "type": "urn:li:dataType:datahub.number",\n  "description": "Retention Time is used to figure out how long to retain records in a dataset",\n  "display_name": "Retention Time",\n  "entity_types": [\n    "urn:li:entityType:datahub.dataset",\n    "urn:li:entityType:datahub.dataFlow"\n  ],\n  "cardinality": "MULTIPLE",\n  "allowed_values": [\n    {\n      "value": "30",\n      "description": "30 days, usually reserved for datasets that are ephemeral and contain pii"\n    },\n    {\n      "value": "90",\n      "description": "Use this for datasets that drive monthly reporting but contain pii"\n    },\n    {\n      "value": "365",\n      "description": "Use this for non-sensitive data that can be retained for longer"\n    }\n  ]\n}\n'))),(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("p",null,"Example Request:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"curl -X 'GET' -v \\\n  'http://localhost:8080/openapi/v2/entity/structuredProperty/urn%3Ali%3AstructuredProperty%3Aio.acryl.privacy.retentionTime/propertyDefinition' \\\n  -H 'accept: application/json' | jq\n")),(0,a.yg)("p",null,"Example Response: "),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},'{\n  "value": {\n    "allowedValues": [\n      {\n        "value": {\n          "double": 30.0\n        },\n        "description": "30 days, usually reserved for datasets that are ephemeral and contain pii"\n      },\n      {\n        "value": {\n          "double": 60.0\n        },\n        "description": "Use this for datasets that drive monthly reporting but contain pii"\n      },\n      {\n        "value": {\n          "double": 365.0\n        },\n        "description": "Use this for non-sensitive data that can be retained for longer"\n      }\n    ],\n    "qualifiedName": "io.acryl.privacy.retentionTime",\n    "displayName": "Retention Time",\n    "valueType": "urn:li:dataType:datahub.number",\n    "description": "Retention Time is used to figure out how long to retain records in a dataset",\n    "entityTypes": [\n      "urn:li:entityType:datahub.dataset",\n      "urn:li:entityType:datahub.dataFlow"\n    ],\n    "cardinality": "MULTIPLE"\n  }\n}\n')))),(0,a.yg)("h2",{id:"set-structured-property-to-a-dataset"},"Set Structured Property To a Dataset"),(0,a.yg)("p",null,"This action will set/replace all structured properties on the entity. See PATCH operations to add/remove a single property."),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"CLI",label:"CLI",default:!0,mdxType:"TabItem"},(0,a.yg)("p",null,"You can set structured properties to a dataset by creating a dataset yaml file with structured properties. For example, below is a dataset yaml file with structured properties in both the field and dataset level. "),(0,a.yg)("p",null,"Please refer to the ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/example-yaml-sp/metadata-ingestion/examples/structured_properties/datasets.yaml"},"full example here.")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},'- id: user_clicks_snowflake\n  platform: snowflake\n  schema:\n    fields:\n      - id: user_id\n        structured_properties:\n          io.acryl.dataManagement.deprecationDate: "2023-01-01"\n  structured_properties:\n    io.acryl.dataManagement.replicationSLA: 90\n')),(0,a.yg)("p",null,"Use the CLI to upsert your dataset yaml file:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},"datahub dataset upsert -f {dataset_yaml}\n")),(0,a.yg)("p",null,"If successful, you should see ",(0,a.yg)("inlineCode",{parentName:"p"},"Update succeeded for urn:li:dataset:..."))),(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("p",null,"Following command will set structured properties ",(0,a.yg)("inlineCode",{parentName:"p"},"retentionTime")," as ",(0,a.yg)("inlineCode",{parentName:"p"},"90")," to a dataset ",(0,a.yg)("inlineCode",{parentName:"p"},"urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)"),".\nPlease note that the structured property and the dataset must exist before executing this command. (You can create sample datasets using the ",(0,a.yg)("inlineCode",{parentName:"p"},"datahub docker ingest-sample-data"),")"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},'curl -X \'POST\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/dataset/urn%3Ali%3Adataset%3A%28urn%3Ali%3AdataPlatform%3Ahive%2CSampleHiveDataset%2CPROD%29/structuredProperties\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n  "properties": [\n    {\n      "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime",\n      "values": [\n        {"string": "90"}\n      ]\n    }\n  ]\n}\' | jq\n')))),(0,a.yg)("h4",{id:"expected-outcomes"},"Expected Outcomes"),(0,a.yg)("p",null,"Once your datasets are uploaded, you can view them in the UI and view the properties associated with them under the Properties tab."),(0,a.yg)("p",{align:"center"},(0,a.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/sp-set.png"})),(0,a.yg)("p",null,"Or you can run the following command to view the properties associated with the dataset:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},"datahub dataset get --urn {urn}\n")),(0,a.yg)("h2",{id:"patch-structured-property-value"},"Patch Structured Property Value"),(0,a.yg)("p",null,"This section will show you how to patch a structured property value - either by removing, adding, or upserting a single property."),(0,a.yg)("h3",{id:"add-structured-property-value"},"Add Structured Property Value"),(0,a.yg)("p",null,"For this example, we'll extend create a second structured property and apply both properties to the same dataset used previously.\nAfter this your system should include both ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime02"),"."),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("p",null,"Let's start by creating the second structured property."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'curl -X \'POST\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/structuredProperty/urn%3Ali%3AstructuredProperty%3Aio.acryl.privacy.retentionTime02/propertyDefinition\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "qualifiedName": "io.acryl.privacy.retentionTime02",\n    "displayName": "Retention Time 02",\n    "valueType": "urn:li:dataType:datahub.string",\n    "allowedValues": [\n        {\n            "value": {"string": "foo2"},\n            "description": "test foo2 value"\n        },\n        {\n            "value": {"string": "bar2"},\n            "description": "test bar2 value"\n        }\n    ],\n    "cardinality": "SINGLE",\n    "entityTypes": [\n        "urn:li:entityType:datahub.dataset"\n    ]\n}\' | jq\n\n')),(0,a.yg)("p",null,"This command will attach one of each of the two properties to our test dataset ",(0,a.yg)("inlineCode",{parentName:"p"},"urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)"),"\nSpecically, this will set ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime")," as ",(0,a.yg)("inlineCode",{parentName:"p"},"90")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime02")," as ",(0,a.yg)("inlineCode",{parentName:"p"},"bar2"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'curl -X \'POST\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/dataset/urn%3Ali%3Adataset%3A%28urn%3Ali%3AdataPlatform%3Ahive%2CSampleHiveDataset%2CPROD%29/structuredProperties\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n  "properties": [\n    {\n      "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime",\n      "values": [\n        {"string": "90"}\n      ]\n    },\n    {\n      "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime02",\n      "values": [\n        {"string": "bar2"}\n      ]\n    }\n  ]\n}\' | jq\n')))),(0,a.yg)("h4",{id:"expected-outcomes-1"},"Expected Outcomes"),(0,a.yg)("p",null,"You can see that the dataset now has two structured properties attached to it."),(0,a.yg)("p",{align:"center"},(0,a.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/sp-add.png"})),(0,a.yg)("h3",{id:"remove-structured-property-value"},"Remove Structured Property Value"),(0,a.yg)("p",null,"The expected state of our test dataset include 2 structured properties.\nWe'd like to remove the first one (",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime"),") and preserve the second property. (",(0,a.yg)("inlineCode",{parentName:"p"},"io.acryl.privacy.retentionTime02"),")."),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'curl -X \'PATCH\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/dataset/urn%3Ali%3Adataset%3A%28urn%3Ali%3AdataPlatform%3Ahive%2CSampleHiveDataset%2CPROD%29/structuredProperties\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json-patch+json\' \\\n  -d \'{\n        "patch": [\n            {\n                "op": "remove",\n                "path": "/properties/urn:li:structuredProperty:io.acryl.privacy.retentionTime"\n            }\n        ],\n        "arrayPrimaryKeys": {\n            "properties": [\n                "propertyUrn"\n            ]\n        }\n      }\' | jq\n')),(0,a.yg)("p",null,"The response will show that the expected property has been removed."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'{\n  "urn": "urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)",\n  "aspects": {\n    "structuredProperties": {\n      "value": {\n        "properties": [\n          {\n            "values": [\n              {\n                "string": "bar2"\n              }\n            ],\n            "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime02"\n          }\n        ]\n      }\n    }\n  }\n}\n')))),(0,a.yg)("h4",{id:"expected-outcomes-2"},"Expected Outcomes"),(0,a.yg)("p",null,"You can see that the first property has been removed and the second property is still present."),(0,a.yg)("p",{align:"center"},(0,a.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/sp-remove.png"})),(0,a.yg)("h3",{id:"upsert-structured-property-value"},"Upsert Structured Property Value"),(0,a.yg)("p",null,"In this example, we'll add the property back with a different value, preserving the existing property."),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'curl -X \'PATCH\' -v \\\n  \'http://localhost:8080/openapi/v2/entity/dataset/urn%3Ali%3Adataset%3A%28urn%3Ali%3AdataPlatform%3Ahive%2CSampleHiveDataset%2CPROD%29/structuredProperties\' \\\n  -H \'accept: application/json\' \\\n  -H \'Content-Type: application/json-patch+json\' \\\n  -d \'{\n        "patch": [\n            {\n                "op": "add",\n                "path": "/properties/urn:li:structuredProperty:io.acryl.privacy.retentionTime",\n                "value": {\n                    "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime",\n                    "values": [\n                        {\n                            "string": "365"\n                        }\n                    ]\n                }\n            }\n        ],\n        "arrayPrimaryKeys": {\n            "properties": [\n                "propertyUrn"\n            ]\n        }\n    }\' | jq\n')),(0,a.yg)("p",null,"Below is the expected response: "),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'{\n  "urn": "urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)",\n  "aspects": {\n    "structuredProperties": {\n      "value": {\n        "properties": [\n          {\n            "values": [\n              {\n                "string": "bar2"\n              }\n            ],\n            "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime02"\n          },\n          {\n            "values": [\n              {\n                "string": "365"\n              }\n            ],\n            "propertyUrn": "urn:li:structuredProperty:io.acryl.privacy.retentionTime"\n          }\n        ]\n      }\n    }\n  }\n}\n')),(0,a.yg)("p",null,"The response shows that the property was re-added with the new value bar instead of the previous value foo."))),(0,a.yg)("h4",{id:"expected-outcomes-3"},"Expected Outcomes"),(0,a.yg)("p",null,"You can see that the first property has been added back with a new value and the second property is still present."),(0,a.yg)("p",{align:"center"},(0,a.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/sp-upsert.png"})),(0,a.yg)("h2",{id:"delete-structured-properties"},"Delete Structured Properties"),(0,a.yg)("p",null,"There are two types of deletion present in DataHub: hard and soft delete. As of the current release only the soft delete is supported for Structured Properties. "),(0,a.yg)("admonition",{title:"SOFT DELETE",type:"note"},(0,a.yg)("p",{parentName:"admonition"},"A soft deleted Structured Property does not remove any underlying data on the Structured Property entity or the Structured Property's values written to other entities. The soft delete is 100% reversible with zero data loss. When a Structured Property is soft deleted, a few operations are not available."),(0,a.yg)("p",{parentName:"admonition"},"Structured Property Soft Delete Effects:"),(0,a.yg)("ul",{parentName:"admonition"},(0,a.yg)("li",{parentName:"ul"},"Entities with a soft deleted Structured Property value will not return the soft deleted properties"),(0,a.yg)("li",{parentName:"ul"},"Updates to a soft deleted Structured Property's definition are denied"),(0,a.yg)("li",{parentName:"ul"},"Adding a soft deleted Structured Property's value to an entity is denied"),(0,a.yg)("li",{parentName:"ul"},"Search filters using a soft deleted Structured Property will be denied"))),(0,a.yg)(n.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"CLI",label:"CLI (Soft Delete)",default:!0,mdxType:"TabItem"},(0,a.yg)("p",null,"The following command will soft delete the test property."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-commandline"},"datahub delete --urn {urn}\n"))),(0,a.yg)(i.A,{value:"OpenAPI",label:"OpenAPI (Soft Delete)",mdxType:"TabItem"},(0,a.yg)("p",null,"The following command will soft delete the test property by writing to the status aspect."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"curl -X 'POST' \\\n  'http://localhost:8080/openapi/v2/entity/structuredProperty/urn%3Ali%3AstructuredProperty%3Aio.acryl.privacy.retentionTime/status?systemMetadata=false' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n\"removed\": true\n}' | jq\n")),(0,a.yg)("p",null,"If you want to ",(0,a.yg)("strong",{parentName:"p"},"remove the soft delete"),", you can do so by either hard deleting the status aspect or changing the removed boolean to ",(0,a.yg)("inlineCode",{parentName:"p"},"false")," like below."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"curl -X 'POST' \\\n  'http://localhost:8080/openapi/v2/entity/structuredProperty/urn%3Ali%3AstructuredProperty%3Aio.acryl.privacy.retentionTime/status?systemMetadata=false' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n\"removed\": false\n}' | jq\n")))))}h.isMDXComponent=!0}}]);